{"ast":null,"code":"import _objectSpread from\"D:/JHFshop/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import{useEffect,useState,createContext,useContext}from\"react\";import{auth,db}from\"../lib/firebase\";import{USERS_COLLECTION,USER_ORDERS_SUB}from\"../lib/collections\";import{clearOldUserData}from\"../services/userData\";import{stripUndefined}from\"../lib/firestore-utils\";import{onAuthStateChanged,signInWithEmailAndPassword,createUserWithEmailAndPassword,signOut,updateProfile,GoogleAuthProvider,signInWithPopup,signInWithRedirect,linkWithPopup,linkWithCredential,fetchSignInMethodsForEmail}from\"firebase/auth\";import{doc,setDoc,getDoc,collection,getDocs,addDoc,serverTimestamp,query,orderBy}from\"firebase/firestore\";import{jsx as _jsx}from\"react/jsx-runtime\";let pendingAccountLink=null;const UserContext=/*#__PURE__*/createContext(undefined);export function UserProvider(_ref){let{children}=_ref;const[user,setUser]=useState(null);const[orders,setOrders]=useState([]);// using shared stripUndefined utility for Firestore writes\nuseEffect(()=>{const unsub=onAuthStateChanged(auth,async fbUser=>{if(fbUser){var _fbUser$photoURL;const uid=fbUser.uid;const profileRef=doc(db,USERS_COLLECTION,uid);const snap=await getDoc(profileRef);let profile={id:uid,email:fbUser.email||\"\",name:fbUser.displayName||\"\",avatar:(_fbUser$photoURL=fbUser.photoURL)!==null&&_fbUser$photoURL!==void 0?_fbUser$photoURL:null,joinedDate:new Date().toISOString().split('T')[0],isSeller:false};if(snap.exists()){const data=snap.data();profile=_objectSpread(_objectSpread(_objectSpread({},profile),data),{},{id:uid});}else{await setDoc(profileRef,stripUndefined(profile),{merge:true});}try{await clearOldUserData(uid);}catch(_unused){}setUser(profile);const q=query(collection(db,USERS_COLLECTION,uid,USER_ORDERS_SUB),orderBy(\"createdAt\",\"desc\"));const ordersSnap=await getDocs(q);const loaded=ordersSnap.docs.map(d=>_objectSpread({id:d.id},d.data()));setOrders(loaded);}else{setUser(null);setOrders([]);}});return()=>unsub();},[]);const login=async(email,password)=>{try{var _auth$currentUser;await signInWithEmailAndPassword(auth,email,password);if(pendingAccountLink&&((_auth$currentUser=auth.currentUser)===null||_auth$currentUser===void 0?void 0:_auth$currentUser.email)===pendingAccountLink.email){try{await linkWithCredential(auth.currentUser,pendingAccountLink.credential);}catch(_unused2){}pendingAccountLink=null;}return true;}catch(_unused3){return false;}};const loginWithGoogle=async()=>{const provider=new GoogleAuthProvider();provider.setCustomParameters({prompt:'select_account'});const inIframe=typeof window!=='undefined'&&window.self!==window.top;try{if(auth.currentUser){if(inIframe){await signInWithRedirect(auth,provider);return{ok:true};}await linkWithPopup(auth.currentUser,provider);return{ok:true};}if(inIframe){await signInWithRedirect(auth,provider);return{ok:true};}await signInWithPopup(auth,provider);return{ok:true};}catch(e){const code=e===null||e===void 0?void 0:e.code;if(code==='auth/popup-blocked'||code==='auth/popup-closed-by-user'){try{await signInWithRedirect(auth,provider);return{ok:true};}catch(e2){return{ok:false,code:e2===null||e2===void 0?void 0:e2.code,message:e2===null||e2===void 0?void 0:e2.message};}}if(code==='auth/account-exists-with-different-credential'){var _e$customData,_GoogleAuthProvider$c;const email=e===null||e===void 0?void 0:(_e$customData=e.customData)===null||_e$customData===void 0?void 0:_e$customData.email;const cred=(_GoogleAuthProvider$c=GoogleAuthProvider.credentialFromError)===null||_GoogleAuthProvider$c===void 0?void 0:_GoogleAuthProvider$c.call(GoogleAuthProvider,e);if(email&&cred){pendingAccountLink={email,credential:cred};try{const methods=await fetchSignInMethodsForEmail(auth,email);if(methods.includes('password')){return{ok:false,code:'link-with-password',message:'Email already used. Sign in with your password to link Google.'};}return{ok:false,code:'link-with-'+(methods[0]||'existing'),message:'Email already used. Sign in with your existing method to link.'};}catch(_unused4){}}}return{ok:false,code,message:e===null||e===void 0?void 0:e.message};}};const signup=async(email,password,name)=>{try{const cred=await createUserWithEmailAndPassword(auth,email,password);if(auth.currentUser){try{await updateProfile(auth.currentUser,{displayName:name});}catch(_unused5){}}const profile={id:cred.user.uid,email,name,avatar:null,joinedDate:new Date().toISOString().split('T')[0],isSeller:false};await setDoc(doc(db,USERS_COLLECTION,cred.user.uid),stripUndefined(profile),{merge:true});try{await clearOldUserData(cred.user.uid);}catch(_unused6){}setUser(profile);setOrders([]);return true;}catch(_unused7){return false;}};const logout=async()=>{await signOut(auth);setUser(null);setOrders([]);};const addOrder=async orderData=>{const newOrder=_objectSpread(_objectSpread({},orderData),{},{id:\"ORD-\".concat(Date.now()),date:new Date().toISOString().split('T')[0]});setOrders(prev=>[newOrder,...prev]);if(user){try{await addDoc(collection(db,USERS_COLLECTION,user.id,USER_ORDERS_SUB),stripUndefined(_objectSpread(_objectSpread({},newOrder),{},{createdAt:serverTimestamp()})));}catch(_unused8){}}};const updateUserProfile=async updates=>{if(user){const next=_objectSpread(_objectSpread({},user),updates);setUser(next);try{await setDoc(doc(db,USERS_COLLECTION,user.id),stripUndefined(updates),{merge:true});}catch(_unused9){}}};return/*#__PURE__*/_jsx(UserContext.Provider,{value:{user,orders,login,loginWithGoogle,signup,logout,addOrder,updateUserProfile},children:children});}export function useUser(){const context=useContext(UserContext);if(context===undefined){throw new Error('useUser must be used within a UserProvider');}return context;}","map":{"version":3,"names":["useEffect","useState","createContext","useContext","auth","db","USERS_COLLECTION","USER_ORDERS_SUB","clearOldUserData","stripUndefined","onAuthStateChanged","signInWithEmailAndPassword","createUserWithEmailAndPassword","signOut","updateProfile","GoogleAuthProvider","signInWithPopup","signInWithRedirect","linkWithPopup","linkWithCredential","fetchSignInMethodsForEmail","doc","setDoc","getDoc","collection","getDocs","addDoc","serverTimestamp","query","orderBy","jsx","_jsx","pendingAccountLink","UserContext","undefined","UserProvider","_ref","children","user","setUser","orders","setOrders","unsub","fbUser","_fbUser$photoURL","uid","profileRef","snap","profile","id","email","name","displayName","avatar","photoURL","joinedDate","Date","toISOString","split","isSeller","exists","data","_objectSpread","merge","_unused","q","ordersSnap","loaded","docs","map","d","login","password","_auth$currentUser","currentUser","credential","_unused2","_unused3","loginWithGoogle","provider","setCustomParameters","prompt","inIframe","window","self","top","ok","e","code","e2","message","_e$customData","_GoogleAuthProvider$c","customData","cred","credentialFromError","call","methods","includes","_unused4","signup","_unused5","_unused6","_unused7","logout","addOrder","orderData","newOrder","concat","now","date","prev","createdAt","_unused8","updateUserProfile","updates","next","_unused9","Provider","value","useUser","context","Error"],"sources":["D:/JHFshop/src/contexts/user-context.tsx"],"sourcesContent":["import { useEffect, useState, createContext, useContext, ReactNode } from \"react\";\nimport { auth, db } from \"../lib/firebase\";\nimport { USERS_COLLECTION, USER_ORDERS_SUB } from \"../lib/collections\";\nimport { clearOldUserData } from \"../services/userData\";\nimport { stripUndefined } from \"../lib/firestore-utils\";\nimport {\n  onAuthStateChanged,\n  signInWithEmailAndPassword,\n  createUserWithEmailAndPassword,\n  signOut,\n  updateProfile,\n  GoogleAuthProvider,\n  signInWithPopup,\n  signInWithRedirect,\n  linkWithPopup,\n  linkWithCredential,\n  fetchSignInMethodsForEmail,\n  EmailAuthProvider,\n} from \"firebase/auth\";\nimport {\n  doc,\n  setDoc,\n  getDoc,\n  collection,\n  getDocs,\n  addDoc,\n  serverTimestamp,\n  query,\n  orderBy,\n} from \"firebase/firestore\";\n\nlet pendingAccountLink: { email: string; credential: any } | null = null;\n\nexport interface User {\n  id: string;\n  email: string;\n  name: string;\n  avatar?: string | null;\n  joinedDate: string;\n  isSeller?: boolean;\n}\n\nexport interface Order {\n  id: string;\n  date: string;\n  status: 'pending' | 'processing' | 'shipped' | 'delivered' | 'cancelled';\n  items: Array<{\n    id: string;\n    name: string;\n    price: number;\n    quantity: number;\n    image: string;\n  }>;\n  total: number;\n  shippingAddress: {\n    name?: string;\n    street: string;\n    city: string;\n    state: string;\n    zipCode: string;\n    country: string;\n  };\n  trackingNumber?: string;\n  carrier?: string;\n  estimatedDelivery?: string;\n}\n\ntype GoogleLoginResult = { ok: true } | { ok: false; code?: string; message?: string };\n\ninterface UserContextType {\n  user: User | null;\n  orders: Order[];\n  login: (email: string, password: string) => Promise<boolean>;\n  loginWithGoogle: () => Promise<GoogleLoginResult>;\n  signup: (email: string, password: string, name: string) => Promise<boolean>;\n  logout: () => Promise<void>;\n  addOrder: (order: Omit<Order, 'id' | 'date'>) => Promise<void>;\n  updateUserProfile: (updates: Partial<Pick<User, 'name' | 'email' | 'avatar'>>) => Promise<void>;\n}\n\nconst UserContext = createContext<UserContextType | undefined>(undefined);\n\nexport function UserProvider({ children }: { children: ReactNode }) {\n  const [user, setUser] = useState<User | null>(null);\n  const [orders, setOrders] = useState<Order[]>([]);\n\n  // using shared stripUndefined utility for Firestore writes\n\n  useEffect(() => {\n    const unsub = onAuthStateChanged(auth, async (fbUser) => {\n      if (fbUser) {\n        const uid = fbUser.uid;\n        const profileRef = doc(db, USERS_COLLECTION, uid);\n        const snap = await getDoc(profileRef);\n        let profile: User = {\n          id: uid,\n          email: fbUser.email || \"\",\n          name: fbUser.displayName || \"\",\n          avatar: fbUser.photoURL ?? null,\n          joinedDate: new Date().toISOString().split('T')[0],\n          isSeller: false,\n        };\n        if (snap.exists()) {\n          const data = snap.data() as Partial<User>;\n          profile = { ...profile, ...data, id: uid } as User;\n        } else {\n          await setDoc(profileRef, stripUndefined(profile), { merge: true });\n        }\n        try { await clearOldUserData(uid); } catch {}\n        setUser(profile);\n        const q = query(collection(db, USERS_COLLECTION, uid, USER_ORDERS_SUB), orderBy(\"createdAt\", \"desc\"));\n        const ordersSnap = await getDocs(q);\n        const loaded: Order[] = ordersSnap.docs.map((d: any) => ({ id: d.id, ...(d.data() as any) }));\n        setOrders(loaded);\n      } else {\n        setUser(null);\n        setOrders([]);\n      }\n    });\n    return () => unsub();\n  }, []);\n\n  const login = async (email: string, password: string): Promise<boolean> => {\n    try {\n      await signInWithEmailAndPassword(auth, email, password);\n      if (pendingAccountLink && auth.currentUser?.email === pendingAccountLink.email) {\n        try {\n          await linkWithCredential(auth.currentUser!, pendingAccountLink.credential);\n        } catch {}\n        pendingAccountLink = null;\n      }\n      return true;\n    } catch {\n      return false;\n    }\n  };\n\n  const loginWithGoogle = async (): Promise<GoogleLoginResult> => {\n    const provider = new GoogleAuthProvider();\n    provider.setCustomParameters({ prompt: 'select_account' });\n    const inIframe = typeof window !== 'undefined' && window.self !== window.top;\n    try {\n      if (auth.currentUser) {\n        if (inIframe) {\n          await signInWithRedirect(auth, provider);\n          return { ok: true };\n        }\n        await linkWithPopup(auth.currentUser, provider);\n        return { ok: true };\n      }\n      if (inIframe) {\n        await signInWithRedirect(auth, provider);\n        return { ok: true };\n      }\n      await signInWithPopup(auth, provider);\n      return { ok: true };\n    } catch (e: any) {\n      const code = e?.code as string | undefined;\n      if (code === 'auth/popup-blocked' || code === 'auth/popup-closed-by-user') {\n        try {\n          await signInWithRedirect(auth, provider);\n          return { ok: true };\n        } catch (e2: any) {\n          return { ok: false, code: e2?.code, message: e2?.message };\n        }\n      }\n      if (code === 'auth/account-exists-with-different-credential') {\n        const email = e?.customData?.email as string | undefined;\n        const cred = GoogleAuthProvider.credentialFromError?.(e);\n        if (email && cred) {\n          pendingAccountLink = { email, credential: cred };\n          try {\n            const methods = await fetchSignInMethodsForEmail(auth, email);\n            if (methods.includes('password')) {\n              return { ok: false, code: 'link-with-password', message: 'Email already used. Sign in with your password to link Google.' };\n            }\n            return { ok: false, code: 'link-with-' + (methods[0] || 'existing'), message: 'Email already used. Sign in with your existing method to link.' };\n          } catch {}\n        }\n      }\n      return { ok: false, code, message: e?.message };\n    }\n  };\n\n  const signup = async (email: string, password: string, name: string): Promise<boolean> => {\n    try {\n      const cred = await createUserWithEmailAndPassword(auth, email, password);\n      if (auth.currentUser) {\n        try { await updateProfile(auth.currentUser, { displayName: name }); } catch {}\n      }\n      const profile: User = {\n        id: cred.user.uid,\n        email,\n        name,\n        avatar: null,\n        joinedDate: new Date().toISOString().split('T')[0],\n        isSeller: false,\n      };\n      await setDoc(doc(db, USERS_COLLECTION, cred.user.uid), stripUndefined(profile), { merge: true });\n      try { await clearOldUserData(cred.user.uid); } catch {}\n      setUser(profile);\n      setOrders([]);\n      return true;\n    } catch {\n      return false;\n    }\n  };\n\n  const logout = async () => {\n    await signOut(auth);\n    setUser(null);\n    setOrders([]);\n  };\n\n  const addOrder = async (orderData: Omit<Order, 'id' | 'date'>) => {\n    const newOrder: Order = {\n      ...orderData,\n      id: `ORD-${Date.now()}`,\n      date: new Date().toISOString().split('T')[0],\n    };\n    setOrders((prev) => [newOrder, ...prev]);\n    if (user) {\n      try {\n        await addDoc(collection(db, USERS_COLLECTION, user.id, USER_ORDERS_SUB), stripUndefined({\n          ...newOrder,\n          createdAt: serverTimestamp(),\n        }));\n      } catch {}\n    }\n  };\n\n  const updateUserProfile = async (updates: Partial<Pick<User, 'name' | 'email' | 'avatar'>>) => {\n    if (user) {\n      const next = { ...user, ...updates } as User;\n      setUser(next);\n      try {\n        await setDoc(doc(db, USERS_COLLECTION, user.id), stripUndefined(updates), { merge: true });\n      } catch {}\n    }\n  };\n\n  return (\n    <UserContext.Provider value={{\n      user,\n      orders,\n      login,\n      loginWithGoogle,\n      signup,\n      logout,\n      addOrder,\n      updateUserProfile,\n    }}>\n      {children}\n    </UserContext.Provider>\n  );\n}\n\nexport function useUser() {\n  const context = useContext(UserContext);\n  if (context === undefined) {\n    throw new Error('useUser must be used within a UserProvider');\n  }\n  return context;\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}