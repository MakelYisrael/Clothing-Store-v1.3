{"ast":null,"code":"import _objectSpread from\"D:/JHFshop/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import{useMemo}from\"react\";import{Badge}from\"./ui/badge\";import{TrendingUp,Flame}from\"lucide-react\";import{useTheme}from\"../contexts/theme-context\";import{useSeller}from\"../contexts/seller-context\";import{ProductCard}from\"./product-card\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export function TopProducts(_ref){let{products,onAddToCart,onToggleWishlist,wishlistItems,onProductClick,limit=6}=_ref;const{sales}=useSeller();// Calculate top products based on sales data\nconst topProducts=useMemo(()=>{// Aggregate sales by product\nconst productSales={};sales.forEach(sale=>{sale.items.forEach(item=>{if(!productSales[item.productId]){productSales[item.productId]={quantity:0,revenue:0};}productSales[item.productId].quantity+=item.quantity;productSales[item.productId].revenue+=item.price*item.quantity;});});// Get products with sales data and sort by quantity sold\nconst productsWithSales=products.map(product=>{var _productSales$product,_productSales$product2;return _objectSpread(_objectSpread({},product),{},{unitsSold:((_productSales$product=productSales[product.id])===null||_productSales$product===void 0?void 0:_productSales$product.quantity)||0,revenue:((_productSales$product2=productSales[product.id])===null||_productSales$product2===void 0?void 0:_productSales$product2.revenue)||0});}).filter(product=>product.unitsSold>0).sort((a,b)=>b.unitsSold-a.unitsSold).slice(0,limit);return productsWithSales;},[sales,products,limit]);// If no products have sales yet, show featured/new products instead\n// Prioritize newest products by sorting by ID (higher ID = newer)\nconst displayProducts=topProducts.length>0?topProducts:products.filter(p=>p.isNew||p.isOnSale).sort((a,b)=>Number(b.id)-Number(a.id)).slice(0,limit);if(displayProducts.length===0){return null;}const{theme}=useTheme();return/*#__PURE__*/_jsx(\"section\",{className:\"pt-8 md:pt-16 pb-8 md:pb-8 bg-muted/20 border-t border-border/60\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"container mx-auto px-3 md:px-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-6 md:mb-8\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2 md:gap-3 mb-1 md:mb-2\",children:[topProducts.length>0?/*#__PURE__*/_jsx(Flame,{className:\"w-6 h-6 md:w-8 md:h-8 text-orange-500\"}):/*#__PURE__*/_jsx(TrendingUp,{className:\"w-6 h-6 md:w-8 md:h-8 text-primary\"}),/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl md:text-3xl text-violet-700 dark:text-violet-300\",children:topProducts.length>0?theme==='dark'?'Trending Tonight':'Trending Now':theme==='dark'?'Editor’s Picks':'Featured Products'})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm md:text-base text-muted-foreground\",children:topProducts.length>0?\"Our most popular products based on customer purchases\":\"Handpicked favorites for you\"})]}),topProducts.length>0&&/*#__PURE__*/_jsxs(Badge,{variant:\"secondary\",className:\"hidden md:flex items-center gap-2\",children:[/*#__PURE__*/_jsx(TrendingUp,{className:\"w-4 h-4\"}),\"Based on \",sales.length,\" sales\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-2 lg:grid-cols-3 gap-3 md:gap-6\",children:displayProducts.map((product,index)=>{const productWithSales=product;return/*#__PURE__*/_jsxs(\"div\",{className:\"relative group\",children:[topProducts.length>0&&productWithSales.unitsSold&&/*#__PURE__*/_jsx(\"div\",{className:\"absolute top-16 right-2 z-20\",children:/*#__PURE__*/_jsxs(Badge,{variant:index===0?\"default\":\"secondary\",className:\"flex items-center gap-1 shadow-md\",children:[index===0&&/*#__PURE__*/_jsx(Flame,{className:\"w-3 h-3\"}),index===0?\"Best Seller\":\"#\".concat(index+1)]})}),/*#__PURE__*/_jsx(ProductCard,{product:product,onAddToCart:onAddToCart,onToggleWishlist:onToggleWishlist,isInWishlist:wishlistItems.includes(product.id),onProductClick:()=>onProductClick(product)}),topProducts.length>0&&productWithSales.unitsSold&&/*#__PURE__*/_jsx(\"div\",{className:\"absolute bottom-20 right-2 z-20\",children:/*#__PURE__*/_jsxs(Badge,{variant:\"outline\",className:\"bg-background/95 backdrop-blur shadow-sm\",children:[productWithSales.unitsSold,\" sold\"]})})]},product.id);})}),topProducts.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"mt-8 text-center\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-muted-foreground\",children:\"Rankings updated based on recent sales activity\"})})]})});}","map":{"version":3,"names":["useMemo","Badge","TrendingUp","Flame","useTheme","useSeller","ProductCard","jsx","_jsx","jsxs","_jsxs","TopProducts","_ref","products","onAddToCart","onToggleWishlist","wishlistItems","onProductClick","limit","sales","topProducts","productSales","forEach","sale","items","item","productId","quantity","revenue","price","productsWithSales","map","product","_productSales$product","_productSales$product2","_objectSpread","unitsSold","id","filter","sort","a","b","slice","displayProducts","length","p","isNew","isOnSale","Number","theme","className","children","variant","index","productWithSales","concat","isInWishlist","includes"],"sources":["D:/JHFshop/src/components/top-products.tsx"],"sourcesContent":["import { useMemo } from \"react\";\r\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"./ui/card\";\r\nimport { Badge } from \"./ui/badge\";\r\nimport { TrendingUp, Flame } from \"lucide-react\";\nimport { useTheme } from \"../contexts/theme-context\";\r\nimport { useSeller } from \"../contexts/seller-context\";\r\nimport { ProductCard, Product } from \"./product-card\";\r\n\r\ninterface TopProductsProps {\r\n  products: Product[];\r\n  onAddToCart: (product: Product, color?: string, size?: string) => void;\r\n  onToggleWishlist: (productId: string) => void;\r\n  wishlistItems: string[];\r\n  onProductClick: (product: Product) => void;\r\n  limit?: number;\r\n}\r\n\r\nexport function TopProducts({\r\n  products,\r\n  onAddToCart,\r\n  onToggleWishlist,\r\n  wishlistItems,\r\n  onProductClick,\r\n  limit = 6\r\n}: TopProductsProps) {\r\n  const { sales } = useSeller();\r\n\r\n  // Calculate top products based on sales data\r\n  const topProducts = useMemo(() => {\r\n    // Aggregate sales by product\r\n    const productSales: { [key: string]: { quantity: number; revenue: number } } = {};\r\n\r\n    sales.forEach(sale => {\r\n      sale.items.forEach(item => {\r\n        if (!productSales[item.productId]) {\r\n          productSales[item.productId] = { quantity: 0, revenue: 0 };\r\n        }\r\n        productSales[item.productId].quantity += item.quantity;\r\n        productSales[item.productId].revenue += item.price * item.quantity;\r\n      });\r\n    });\r\n\r\n    // Get products with sales data and sort by quantity sold\r\n    const productsWithSales = products\r\n      .map(product => ({\r\n        ...product,\r\n        unitsSold: productSales[product.id]?.quantity || 0,\r\n        revenue: productSales[product.id]?.revenue || 0\r\n      }))\r\n      .filter(product => product.unitsSold > 0)\r\n      .sort((a, b) => b.unitsSold - a.unitsSold)\r\n      .slice(0, limit);\r\n\r\n    return productsWithSales;\r\n  }, [sales, products, limit]);\r\n\r\n  // If no products have sales yet, show featured/new products instead\r\n  // Prioritize newest products by sorting by ID (higher ID = newer)\r\n  const displayProducts = topProducts.length > 0 \r\n    ? topProducts \r\n    : products\r\n        .filter(p => p.isNew || p.isOnSale)\r\n        .sort((a, b) => Number(b.id) - Number(a.id))\r\n        .slice(0, limit);\r\n\r\n  if (displayProducts.length === 0) {\r\n    return null;\r\n  }\r\n\r\n  const { theme } = useTheme();\n  return (\n    <section className=\"pt-8 md:pt-16 pb-8 md:pb-8 bg-muted/20 border-t border-border/60\">\r\n      <div className=\"container mx-auto px-3 md:px-4\">\r\n        <div className=\"flex items-center justify-between mb-6 md:mb-8\">\r\n          <div>\r\n            <div className=\"flex items-center gap-2 md:gap-3 mb-1 md:mb-2\">\r\n              {topProducts.length > 0 ? (\r\n                <Flame className=\"w-6 h-6 md:w-8 md:h-8 text-orange-500\" />\r\n              ) : (\r\n                <TrendingUp className=\"w-6 h-6 md:w-8 md:h-8 text-primary\" />\r\n              )}\r\n              <h2 className=\"text-2xl md:text-3xl text-violet-700 dark:text-violet-300\">\n                {topProducts.length > 0\n                  ? (theme === 'dark' ? 'Trending Tonight' : 'Trending Now')\n                  : (theme === 'dark' ? 'Editor’s Picks' : 'Featured Products')}\n              </h2>\r\n            </div>\r\n            <p className=\"text-sm md:text-base text-muted-foreground\">\r\n              {topProducts.length > 0 \r\n                ? \"Our most popular products based on customer purchases\"\r\n                : \"Handpicked favorites for you\"}\r\n            </p>\r\n          </div>\r\n          {topProducts.length > 0 && (\r\n            <Badge variant=\"secondary\" className=\"hidden md:flex items-center gap-2\">\r\n              <TrendingUp className=\"w-4 h-4\" />\r\n              Based on {sales.length} sales\r\n            </Badge>\r\n          )}\r\n        </div>\r\n\r\n        <div className=\"grid grid-cols-2 lg:grid-cols-3 gap-3 md:gap-6\">\r\n          {displayProducts.map((product, index) => {\r\n            const productWithSales = product as Product & { unitsSold?: number; revenue?: number };\r\n            return (\r\n              <div key={product.id} className=\"relative group\">\r\n                {/* Trending/Best Seller Badge - Over image */}\r\n                {topProducts.length > 0 && productWithSales.unitsSold && (\r\n                  <div className=\"absolute top-16 right-2 z-20\">\r\n                    <Badge \r\n                      variant={index === 0 ? \"default\" : \"secondary\"} \r\n                      className=\"flex items-center gap-1 shadow-md\"\r\n                    >\r\n                      {index === 0 && <Flame className=\"w-3 h-3\" />}\r\n                      {index === 0 ? \"Best Seller\" : `#${index + 1}`}\r\n                    </Badge>\r\n                  </div>\r\n                )}\r\n                \r\n                <ProductCard\r\n                  product={product}\r\n                  onAddToCart={onAddToCart}\r\n                  onToggleWishlist={onToggleWishlist}\r\n                  isInWishlist={wishlistItems.includes(product.id)}\r\n                  onProductClick={() => onProductClick(product)}\r\n                />\r\n                \r\n                {/* Units Sold Badge - Below image area */}\r\n                {topProducts.length > 0 && productWithSales.unitsSold && (\r\n                  <div className=\"absolute bottom-20 right-2 z-20\">\r\n                    <Badge variant=\"outline\" className=\"bg-background/95 backdrop-blur shadow-sm\">\r\n                      {productWithSales.unitsSold} sold\r\n                    </Badge>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            );\r\n          })}\r\n        </div>\r\n\r\n        {topProducts.length > 0 && (\r\n          <div className=\"mt-8 text-center\">\r\n            <p className=\"text-sm text-muted-foreground\">\r\n              Rankings updated based on recent sales activity\r\n            </p>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </section>\r\n  );\r\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}